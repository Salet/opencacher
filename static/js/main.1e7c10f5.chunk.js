(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,a){e.exports=a(19)},16:function(e,t,a){},17:function(e,t,a){},18:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(8),c=a.n(o),s=(a(16),a(1)),l=a(2),r=a(4),h=a(3),u=a(5),d=(a(17),a(9)),m=a(6),b="https://opencaching.pl/okapi/",p=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"fetchCachesNearest",value:function(e){var t="".concat(b).concat("services/caches/search/nearest").concat("?consumer_key=8v5yBJfdTpcsxEnzUPah","&center=").concat(e.latitude,"|").concat(e.longitude);return fetch(t).then(function(e){return e.json()})}},{key:"fetchCachesDetails",value:function(e){var t="".concat(b).concat("services/caches/geocaches").concat("?consumer_key=8v5yBJfdTpcsxEnzUPah","&cache_codes=").concat(e.join("|"),"&fields=code|name|location|type|status|size2|difficulty|terrain|rating|recommendations");return fetch(t).then(function(e){return e.json()})}}]),e}();function g(e,t){var a=t.latitude*Math.PI/180-e.latitude*Math.PI/180,n=t.longitude*Math.PI/180-e.longitude*Math.PI/180,i=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e.latitude*Math.PI/180)*Math.cos(t.latitude*Math.PI/180)*Math.sin(n/2)*Math.sin(n/2);return 12756.274*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*1e3}a(18);var v=function(e){function t(e,a){var n;return Object(s.a)(this,t),(n=Object(r.a)(this,Object(h.a)(t).call(this,e,a))).cachesService=new p,n.state={nearestCodes:[],nearestDetails:[]},n.cachesService.fetchCachesNearest(n.props.geolocation).then(n.handleCachesNearest.bind(Object(m.a)(Object(m.a)(n)))),n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.geolocation.latitude!==e.geolocation.latitude&&this.cachesService.fetchCachesNearest(this.props.geolocation).then(this.handleCachesNearest.bind(this))}},{key:"handleCachesNearest",value:function(e){this.setState({nearestCodes:e.results}),this.cachesService.fetchCachesDetails(this.state.nearestCodes).then(this.handleCachesDetails.bind(this))}},{key:"handleCachesDetails",value:function(e){var t=[],a=!0,n=!1,i=void 0;try{for(var o,c=this.state.nearestCodes[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var s=o.value;t.push(Object(d.a)({distance:e[s].location?g({latitude:this.props.geolocation.latitude,longitude:this.props.geolocation.longitude},{latitude:0|+e[s].location.split("|")[0],longitude:0|+e[s].location.split("|")[1]}):1e5},e[s]))}}catch(l){n=!0,i=l}finally{try{a||null==c.return||c.return()}finally{if(n)throw i}}this.setState({nearestDetails:t})}},{key:"renderCache",value:function(e){var t=this;return i.a.createElement("div",{className:"Nearby-cache",onClick:function(){t.props.onCacheClick(e)}},i.a.createElement("h3",null,e.name),i.a.createElement("p",null,"Dystans: ~",Math.round(e.distance),"m | Typ: ",e.type," | Ocena:"," ",e.rating," | Rozmiar: ",e.size2," | Teren: ",e.terrain," | Rekomendacje: ",e.recommendations),i.a.createElement("hr",{className:"Nearby-separator"}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"Nearby"},this.state.nearestDetails.map(function(t){return e.renderCache(t)}))}}]),t}(n.Component),f={distance:0,code:"",name:"",location:"",status:"",type:"",size2:"",difficulty:0,terrain:0,rating:0,recommendations:0},y=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(h.a)(t).call(this,e))).state={cache:f},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){this.setState({cache:this.props.cache||f})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("h3",null,this.state.cache.name),i.a.createElement("h5",null,this.state.cache.code),i.a.createElement("br",null),i.a.createElement("p",null,"Status: ",this.state.cache.status),i.a.createElement("p",null,"Typ: ",this.state.cache.type),i.a.createElement("p",null,"Dystans: ~",Math.round(this.state.cache.distance),"m"),i.a.createElement("p",null,"Lokacja: ",this.state.cache.location.split("|").join(" ")),i.a.createElement("br",null),i.a.createElement("p",null,"Ocena: ",this.state.cache.rating,"/5"),i.a.createElement("p",null,"Rekomendacje: ",this.state.cache.recommendations),i.a.createElement("br",null),i.a.createElement("p",null,"Rozmiar: ",this.state.cache.size2),i.a.createElement("p",null,"Trudno\u015b\u0107: ",this.state.cache.difficulty,"/5"),i.a.createElement("p",null,"Teren: ",this.state.cache.terrain,"/5"))}}]),t}(n.Component),E=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(r.a)(this,Object(h.a)(t).call(this,e))).state={page:"nearby",currentCache:null,geolocationReliable:!1,geolocationObject:!!navigator.geolocation,geolocationEnabled:!1,geolocation:{latitude:0,longitude:0,accuracy:0},orientationReliable:!1,orientationRelativeEvents:"ondeviceorientation"in window,orientationAbsoluteEvents:"ondeviceorientationabsolute"in window,orientation:{absolute:!1,alpha:0,beta:0,gamma:0,webkitCompassHeading:0}},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillMount",value:function(){window.addEventListener(this.state.orientationAbsoluteEvents?"deviceorientationabsolute":"deviceorientation",this.handleOrientationEvent.bind(this),!0),this.state.geolocationObject&&navigator.geolocation.getCurrentPosition(this.handlePositionEvent.bind(this),function(){},{enableHighAccuracy:!0})}},{key:"handleOrientationEvent",value:function(e){this.state.orientationReliable||this.setState({orientationReliable:!!e.webkitCompassHeading||e.absolute&&!!e.alpha}),this.setState({orientation:{absolute:e.absolute||!1,alpha:+(e.alpha||0).toFixed(2),beta:+(e.beta||0).toFixed(2),gamma:+(e.gamma||0).toFixed(2),webkitCompassHeading:+(e.webkitCompassHeading||0).toFixed(2)}})}},{key:"handlePositionEvent",value:function(e){this.state.geolocationEnabled||this.setState({geolocationEnabled:!0}),this.state.geolocationReliable||this.setState({geolocationReliable:!!e.coords.latitude||!!e.coords.longitude}),this.setState({geolocation:{latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy}})}},{key:"handleCacheClick",value:function(e){this.setState({currentCache:e}),this.setPage("details")}},{key:"setPage",value:function(e){this.setState({page:e})}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement("h1",null,"Opencacher"),i.a.createElement("div",{className:"App-menu"},i.a.createElement("a",{href:"#",onClick:this.setPage.bind(this,"nearby")},"Nearby")," ","|\xa0",i.a.createElement("a",{href:"#",onClick:this.setPage.bind(this,"debug")},"Debug info")),"debug"==this.state.page&&i.a.createElement("div",null,i.a.createElement("p",null,"Geolocation object: ",this.state.geolocationObject?"yes":"no"),i.a.createElement("p",null,"Geolocation enabled:"," ",this.state.geolocationEnabled?"yes":"no"),i.a.createElement("p",null,"Geolocation reading: ",JSON.stringify(this.state.geolocation)),i.a.createElement("b",null,"Geolocation reliable:"," ",this.state.geolocationReliable?"yes":"no"),i.a.createElement("p",null,"-----"),i.a.createElement("p",null,"Orientation relative events:"," ",this.state.orientationRelativeEvents?"yes":"no"),i.a.createElement("p",null,"Orientation absolute events:"," ",this.state.orientationAbsoluteEvents?"yes":"no"),i.a.createElement("p",null,"Orientation webkit events:"," ",this.state.orientation.webkitCompassHeading?"yes":"no"),i.a.createElement("p",null,"Orientation reading: ",JSON.stringify(this.state.orientation)),i.a.createElement("b",null,"Orientation reliable:"," ",this.state.orientationReliable?"yes":"no")),"nearby"==this.state.page&&i.a.createElement(v,{geolocation:this.state.geolocation,onCacheClick:this.handleCacheClick.bind(this)}),"details"==this.state.page&&i.a.createElement(y,{cache:this.state.currentCache}))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[10,1,2]]]);
//# sourceMappingURL=main.1e7c10f5.chunk.js.map